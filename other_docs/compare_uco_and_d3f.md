# Сравнение UCO и D3F

В этом документе я изложу понимание, к которому пришел, изучая два фреймворка для описания знаний в сфере кибербезопасности: онтологии MITRE D3FEND (D3F) и Unified Cyber Ontology (UCO).

Последую предложенной схеме.
* Опишу основные аспекты, в которых онтологии различаются.
* Укажу на плюсы и минусы данных онтологий.
* Приведу практические рекомендации об их использовании в Positive Technologies.

Расшифровка используемых в тексте сокращений и аббревиатур приводится в конце документа.

## Различия

### Решаемые задачи


#### D3F
D3F имеют своей целью сделать более эффективными процессы противодействия кибератакам у клиентов корпорации MITRE - различных американских госорганов. Фокус онтологии - на контрмерах, доступных хорошо структурированной организации.

#### UCO
UCO позиционирует себя как базовую платформу для создания конкретных прикладных онтологий в сфере кибербезопасности для организаций и предпритий различного типа.

### Способ создания

#### D3F
* Разработка онтологии в рамках одной рабочей группы компании MITRE.

#### UCO
* Разработка первых версий онтологии силами технического комитета Technical Steering Committee
* Создание расширений к онтологии различными заинтересованными группами сообщества и дальнейшая инкорпорация этих расширений в новые версии онтологии через взаимодействие с UCO Ontology Committee.

### Текущий статус

Обе онтологии находится в процессе активного развития, что связано с бурным развитием самой отрасли кибербезопасности.

### Источники информации при проектировании онтологии

#### D3F
* Таксономии и онтологии, разработанные ранее в MITRE
* Корпус американских патентов в сфере ИТ-безопасности, начиная с 2001 года.

#### UCO
* За основу подхода в построении UCO взяты принципы CyBox

### Онтология

Обе онтологии описаны на языке OWL 2.

#### UCO
* Распределена по нескольким файлам (неймспейсам), сфокусированных на разных аспектах онтологии. Собирается в единый граф с помощью `owl:imports`
* Размер: 420 классов, 177 объектных свойств и 576 свойств-значений.
* Использует модель расширения через фасеты `core:Facet`

#### D3F
* Представлена в монолитном файле формата Turtle/RDF (более 30К строк)
* Размер: 2836 классов и 202 объектных свойств и 40 свойств-значений.
* Использует больше конструкций языка OWL (более семантически насыщена).
* Использует трехуровневую модель классификации контрмер безопасности.

### Данные

#### UCO
В UCO единица данных является индивидуальным объектом, обладает типом (привязана к классу онтологии или фасету) и имеет глобальный уникальный идентификатор. В доке об этом сказано напрямую: <cite>"All objects in UCO must specify a globally unique identifier ...and an assertion of the class type of the object."</cite>

UCO связывается с пользовательскими данными через механизм фасетов, который позволяет пользователям задавать собственные типы и атрибуты объектов, а также определять их значения, не прибегая при этом к изменению самой UCO.

В целом, доменный граф UCO можно представить как граф с расширенной реификацией, которая делает его фактически эквивалентным LPG графу.

#### D3F
В то же время, данные D3FEND даются в виде списка (массив объектов JSON) без глобального уникального идентификатора. Это можно выяснить, загрузив файл данных со [страницы ресурсов](https://d3fend.mitre.org/resources/ontology/). Отсюда можно заключить, что данные в D3F по умолчанию не сводятся в глобальный граф и работу с ними предполагается вести через программный код непосредствено, либо же динамически создавать каждый раз новый LPG граф, назначая уникальные идентификаторы узлам "на лету".

### Механизмы валидации данных

#### UCO

UCO использует язык SHACL для валидации, зачастую дублируя его базовыми терминами из RDFS (`rdfs:domain`, `rdfs:range`).

#### D3F

Нет встроенных механизмов валидации, но используется стандартный способ описывать ограничения и определять подклассы с помощью `owl:Restriction` и `rdfs:domain`, `rdfs:range`.

## Плюсы и минусы

* D3F готова к использованию "из коробки". UCO, как онтология среднего уровня потребует доработки специальной низкоуровневой онтологии.

* D3F более детальна. В ней с большей гранулярностью описаны объекты контекста кибербезопасности - атакуемые объекты, инструменты и методики атаки и противодействия.

* UCO пригодна для использования в большем числе контекстов.

* UCO открыта для изменений со стороны внешних групп разработчиков, D3F доступна только в режиме read-only и развивается в рамках корпорации MITRE


## Рекомендации

Для того, чтобы уверенно давать рекомендации, мне следовало бы больше знать про контекст, в котором предполагается использовать онтологию. В общем, можно было бы рекомендовать разработку специальной онтологии, соответствующей контексту и задачам предприятия, с опорой на UCO. Используя при этом актуальное подмножество терминов из D3F (не импортируя их напрямую, а создавая привязку, за счет, например, создания подклассов или введения специального UCO фасета под D3F)

## Используемые аббревиатуры

* *CybOX* - Cyber Observable eXpression. Язык (на основе XML) для определения фактов киберреальности.
* *LPG* - Labeled Property Graph. Граф, у которого ребра могут иметь собственные параметры. Противопоставляется RDF графу.
* *OWL* - Web Ontology Language. Самый распространенный в настоящее время язык описания онтологий.
* *RDF* - Resource Description Framework. Универсальный способ записи информации через триплеты *subject - predicate - object*
* *RDF граф* - Граф, у которого ребра не обладают уникальными свойствами и неуникально специфицируются привязкой к индивиду подкласса rdf:Property, то есть, фактически, различаются только своим типом.
* *SHACL* - Shapes Constraint Language. Один из современных языков для описания ограничений на связи в данных. Наследник языков SPIN и RuleML.
* *UCO* - Unified Cybersecurity Ontology
